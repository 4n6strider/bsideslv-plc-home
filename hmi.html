<!DOCTYPE html>
<html>
<head>
<title>A Trivial HMI</title>
<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<style type="text/css">
table {
	border: 1px solid black;
	border-collapse: collapse;
}
th {
	font-weight: normal;
	border: 1px solid black;
}
td {
	text-align: center;
	border: 1px solid black;
}
.reg { text-align: left; }
</style>
</head>
<body>
<h1>A Trivial HMI</h1>
<p>Sorry, I'm really bad at human interface.</p>
<h2>Status</h2>
<table>
<tr>
<th>DI 1</th>
<th>DI 2</th>
<th>DI 3</th>
<th>DI 4</th>
<th>DI 5</th>
<th>DI 6</th>
<th>DI 7</th>
<th>DI 8</th>
<th>DI 9</th>
<th>DI 10</th>
</tr>
<tr>
<td><span id="di01">--</span></td>
<td><span id="di02">--</span></td>
<td><span id="di03">--</span></td>
<td><span id="di04">--</span></td>
<td><span id="di05">--</span></td>
<td><span id="di06">--</span></td>
<td><span id="di07">--</span></td>
<td><span id="di08">--</span></td>
<td><span id="di09">--</span></td>
<td><span id="di10">--</span></td>
</tr>
<tr>
<th>DI 11</th>
<th>DI 12</th>
<th>DI 13</th>
<th>DI 14</th>
<th>DI 15</th>
<th>DI 16</th>
<th>DI 17</th>
<td colspan="3" class="reg">
Register 1: <span id="re01">--</span>
</td>
</tr>
<tr>
<td><span id="di11">--</span></td>
<td><span id="di12">--</span></td>
<td><span id="di13">--</span></td>
<td><span id="di14">--</span></td>
<td><span id="di15">--</span></td>
<td><span id="di16">--</span></td>
<td><span id="di17">--</span></td>
<td colspan="3" class="reg">
Register 2: <span id="re02">--</span>
</td>
</tr>
</table>

<script>
window.onload = function() {
	var s = new WebSocket("ws://" + window.location.hostname + ":8000/data");
	var color = ['#f88', '#3c3'];

	s.onopen = function() {
		s.send('hi');
	};
	s.onmessage = function(e) {
		var v = e.data.split(',');
		for(var i = 0; i < v.length - 2; i++) {	// v[0] is DI#1
			var di = ('00' + i).slice(-2);
			$('#di'+di)
				.html('&nbsp;' + v[i] + '&nbsp;')
				.css('background-color', color[v[i]]);
		}
		$('#re01').text(v[18]);
		$('#re02').text(v[19]);
		s.send('');
	};
};
</script>
</body>
</html>
